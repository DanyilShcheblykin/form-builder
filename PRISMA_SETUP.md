# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prisma

## –®–∞–≥–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Prisma

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install prisma @prisma/client
```

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client

```bash
npx prisma generate
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ï—Å–ª–∏ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ –ë–î (—Å–æ–∑–¥–∞–Ω–Ω—ã–µ –±–µ–∑ Prisma), —á–∏—Ç–∞–π —Ä–∞–∑–¥–µ–ª –Ω–∏–∂–µ!**

**–í–∞–∂–Ω–æ:** –ï—Å—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—É –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: `prisma db push` (–±—ã—Å—Ç—Ä–æ, –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π)

```bash
npx prisma db push
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –°—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å—Ö–µ–º—É –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå **–ù–ï —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π**
- ‚ö†Ô∏è –ü–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –∫–æ–≥–¥–∞ –Ω–µ –Ω—É–∂–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: `prisma migrate dev` (—Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npx prisma migrate dev --name init
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É `prisma/migrations/` —Å SQL —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
```
prisma/
  ‚îú‚îÄ‚îÄ migrations/
  ‚îÇ   ‚îî‚îÄ‚îÄ 20241204150000_init/
  ‚îÇ       ‚îî‚îÄ‚îÄ migration.sql    ‚Üê SQL –º–∏–≥—Ä–∞—Ü–∏—è –∑–¥–µ—Å—å
  ‚îî‚îÄ‚îÄ schema.prisma
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å —Å—Ö–µ–º—ã –ë–î.

---

## üîÑ –†–∞–±–æ—Ç–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

**–ï—Å–ª–∏ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ –ë–î (—Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ Prisma), –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:**

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º—ã

–°–Ω–∞—á–∞–ª–∞ —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç–≤–æ—è —Å—Ö–µ–º–∞ `prisma/schema.prisma` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–∞–±–ª–∏—Ü–∞–º.

**–ï—Å–ª–∏ —Å—Ö–µ–º–∞ –ù–ï —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç:**
```bash
# –í—ã—Ç—è–Ω–∏ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –≤ schema.prisma
npx prisma db pull
```
–≠—Ç–æ –æ–±–Ω–æ–≤–∏—Ç `schema.prisma` –ø–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î.

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π baseline –º–∏–≥—Ä–∞—Ü–∏—é

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ö–µ–º–µ, —Å–æ–∑–¥–∞–π baseline –º–∏–≥—Ä–∞—Ü–∏—é (–ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—É—é):

```bash
# –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–ï–ó –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (—Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –µ—Å—Ç—å)
npx prisma migrate dev --name init --create-only
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏, –Ω–æ –ù–ï –ø—Ä–∏–º–µ–Ω–∏—Ç –µ–≥–æ.

### –®–∞–≥ 3: –ü–æ–º–µ—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—É—é

```bash
# –ü–æ–º–µ—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∫–∞–∫ —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—É—é –∫ –ë–î
npx prisma migrate resolve --applied init
```

–ò–ª–∏ –µ—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –∏–º–µ–µ—Ç –¥—Ä—É–≥–æ–µ –∏–º—è (—Å –¥–∞—Ç–æ–π):
```bash
# –°–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏ –∏–º—è –º–∏–≥—Ä–∞—Ü–∏–∏
ls prisma/migrations/

# –ó–∞—Ç–µ–º –ø–æ–º–µ—Ç–∏—Ç—å –µ—ë
npx prisma migrate resolve --applied 20241204150000_init
```

### –®–∞–≥ 4: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma Client

```bash
npx prisma generate
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–ø—Ä–æ—â–µ, –Ω–æ –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π):

–ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –º–∏–≥—Ä–∞—Ü–∏–π, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ö–µ–º–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ë–î
npx prisma db push --accept-data-loss

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç
npx prisma generate
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** `db push` –Ω–µ —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π, —Ç–æ–ª—å–∫–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—Ö–µ–º—É —Å –ë–î.

---

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã

–û—Ç–∫—Ä–æ–π Prisma Studio –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

```bash
npx prisma studio
```

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

‚úÖ –£–±—Ä–∞–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü –∏–∑ endpoint'–æ–≤  
‚úÖ –í—Å–µ API routes –ø–µ—Ä–µ–ø–∏—Å–∞–Ω—ã –Ω–∞ Prisma  
‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ö–µ–º–∞ –≤ `prisma/schema.prisma`  
‚úÖ –°–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç Prisma –≤ `src/lib/prisma.ts`  

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

- **Form** - —Ñ–æ—Ä–º—ã —Å –ø–æ–ª—è–º–∏ `id`, `name`, `description`, `form_data`, `created_at`, `updated_at`
- **FormSubmission** - –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º —Å –ø–æ–ª—è–º–∏ `id`, `form_id`, `submission_data`, `submitted_at`

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:

### –ü–µ—Ä–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è):
```bash
npx prisma migrate dev --name init
```

### –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã:

1. **–ò–∑–º–µ–Ω–∏ —Å—Ö–µ–º—É** –≤ `prisma/schema.prisma` (–¥–æ–±–∞–≤—å –ø–æ–ª–µ, –º–æ–¥–µ–ª—å –∏ —Ç.–¥.)
2. **–°–æ–∑–¥–∞–π –º–∏–≥—Ä–∞—Ü–∏—é:**
   ```bash
   npx prisma migrate dev --name add_user_field
   ```
3. Prisma –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –°—Ä–∞–≤–Ω–∏—Ç —Å—Ç–∞—Ä—É—é –∏ –Ω–æ–≤—É—é —Å—Ö–µ–º—É
   - –°–æ–∑–¥–∞—Å—Ç SQL –º–∏–≥—Ä–∞—Ü–∏—é –≤ `prisma/migrations/YYYYMMDDHHMMSS_add_user_field/migration.sql`
   - –ü—Ä–∏–º–µ–Ω–∏—Ç –µ—ë –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
   - –û–±–Ω–æ–≤–∏—Ç Prisma Client

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ –¥—Ä—É–≥–∏—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö:

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –±–∞–∑–µ
npx prisma migrate deploy

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
npx prisma migrate status
```

### –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π:

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é (—Ç–æ–ª—å–∫–æ –≤ dev)
npx prisma migrate resolve --rolled-back "–∏–º—è_–º–∏–≥—Ä–∞—Ü–∏–∏"
```

## üî• –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—É–¥–∞–ª–∏—Ç—å –≤—Å—ë –∏ —Å–æ–∑–¥–∞—Ç—å –∑–∞–Ω–æ–≤–æ)

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã!**

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°–±—Ä–æ—Å —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–Ω–æ–≤–æ
npx prisma migrate reset
```

–≠—Ç–æ:
- ‚úÖ –£–¥–∞–ª–∏—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–Ω–æ–≤–æ
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç seed (–µ—Å–ª–∏ –µ—Å—Ç—å)
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–±—Ä–æ—Å –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π (–±—ã—Å—Ç—Ä–æ)

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–æ–∑–¥–∞—Ç—å –∑–∞–Ω–æ–≤–æ –ø–æ —Å—Ö–µ–º–µ
npx prisma db push --force-reset
```

–≠—Ç–æ:
- ‚úÖ –£–¥–∞–ª–∏—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –ø–æ —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º–µ
- ‚ùå –ù–ï —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
- ‚ö†Ô∏è –ü–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–¥–∞–ª–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å –Ω—É–ª—è

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
# 1. –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É –º–∏–≥—Ä–∞—Ü–∏–π (–µ—Å–ª–∏ –µ—Å—Ç—å)
rm -rf prisma/migrations

# 2. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –≤–∞—Ä–∏–∞–Ω—Ç 2 –≤—ã—à–µ

# 3. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma migrate dev --name init

# 4. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç
npx prisma generate
```

---

## –í–∞–∂–Ω–æ:

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏:
1. `npx prisma generate` - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
2. `npx prisma db push` (–±—ã—Å—Ç—Ä–æ) –∏–ª–∏ `npx prisma migrate dev --name init` (—Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏) - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü

